{"version":3,"sources":["../../../../Kryptotrac-xx-1/lib/analytics.ts"],"sourcesContent":["export interface PortfolioMetrics {\r\n  sharpeRatio: number\r\n  volatility: number\r\n  maxDrawdown: number\r\n  diversificationScore: number\r\n  riskScore: number\r\n}\r\n\r\nexport interface BenchmarkComparison {\r\n  portfolioReturn: number\r\n  btcReturn: number\r\n  ethReturn: number\r\n  outperformanceBtc: number\r\n  outperformanceEth: number\r\n}\r\n\r\nexport function calculateSharpeRatio(returns: number[], riskFreeRate = 0.02): number {\r\n  if (returns.length < 2) return 0\r\n\r\n  const avgReturn = returns.reduce((sum, r) => sum + r, 0) / returns.length\r\n  const variance = returns.reduce((sum, r) => sum + Math.pow(r - avgReturn, 2), 0) / returns.length\r\n  const stdDev = Math.sqrt(variance)\r\n\r\n  if (stdDev === 0) return 0\r\n  return (avgReturn - riskFreeRate / 365) / stdDev\r\n}\r\n\r\nexport function calculateVolatility(returns: number[]): number {\r\n  if (returns.length < 2) return 0\r\n\r\n  const avgReturn = returns.reduce((sum, r) => sum + r, 0) / returns.length\r\n  const variance = returns.reduce((sum, r) => sum + Math.pow(r - avgReturn, 2), 0) / returns.length\r\n  const dailyVolatility = Math.sqrt(variance)\r\n\r\n  // Annualized volatility\r\n  return dailyVolatility * Math.sqrt(365) * 100\r\n}\r\n\r\nexport function calculateMaxDrawdown(values: number[]): number {\r\n  if (values.length < 2) return 0\r\n\r\n  let maxDrawdown = 0\r\n  let peak = values[0]\r\n\r\n  for (let i = 1; i < values.length; i++) {\r\n    if (values[i] > peak) {\r\n      peak = values[i]\r\n    }\r\n    const drawdown = ((peak - values[i]) / peak) * 100\r\n    if (drawdown > maxDrawdown) {\r\n      maxDrawdown = drawdown\r\n    }\r\n  }\r\n\r\n  return maxDrawdown\r\n}\r\n\r\nexport function calculateDiversificationScore(holdings: { current_value: number }[]): number {\r\n  if (holdings.length === 0) return 0\r\n  if (holdings.length === 1) return 20\r\n\r\n  const totalValue = holdings.reduce((sum, h) => sum + h.current_value, 0)\r\n  const weights = holdings.map((h) => h.current_value / totalValue)\r\n\r\n  // Herfindahl-Hirschman Index\r\n  const hhi = weights.reduce((sum, w) => sum + Math.pow(w, 2), 0)\r\n\r\n  // Convert to 0-100 score (lower HHI = better diversification)\r\n  const score = (1 - hhi) * 100\r\n\r\n  // Bonus for holding more assets\r\n  const assetBonus = Math.min(holdings.length * 5, 30)\r\n\r\n  return Math.min(score + assetBonus, 100)\r\n}\r\n\r\nexport function calculateRiskScore(volatility: number, maxDrawdown: number): number {\r\n  // Combine volatility and drawdown into risk score (0-100, higher = riskier)\r\n  const volScore = Math.min((volatility / 100) * 100, 100)\r\n  const ddScore = Math.min(maxDrawdown, 100)\r\n\r\n  return volScore * 0.6 + ddScore * 0.4\r\n}\r\n\r\nexport function generateDailyReturns(\r\n  holdings: { quantity: number; purchase_price: number; current_price: number }[],\r\n): number[] {\r\n  // Simulate daily returns based on current position\r\n  // In production, this would use historical price data\r\n  const totalCost = holdings.reduce((sum, h) => sum + h.quantity * h.purchase_price, 0)\r\n  const totalValue = holdings.reduce((sum, h) => sum + h.quantity * h.current_price, 0)\r\n  const totalReturn = (totalValue - totalCost) / totalCost\r\n\r\n  // Generate 30 days of simulated returns with some randomness\r\n  const returns: number[] = []\r\n  const dailyReturn = totalReturn / 30\r\n\r\n  for (let i = 0; i < 30; i++) {\r\n    const randomFactor = (Math.random() - 0.5) * 0.02 // +/- 1% randomness\r\n    returns.push(dailyReturn + randomFactor)\r\n  }\r\n\r\n  return returns\r\n}\r\n\r\n// calculateRealMetrics can only be imported from @/lib/analytics-server in server components\r\n"],"names":[],"mappings":"uCAgBO,SAAS,EAAqB,CAAiB,CAAE,EAAe,GAAI,EACzE,GAAI,EAAQ,MAAM,CAAG,EAAG,OAAO,EAE/B,IAAM,EAAY,EAAQ,MAAM,CAAC,CAAC,EAAK,IAAM,EAAM,EAAG,GAAK,EAAQ,MAAM,CAEnE,EAAS,KAAK,IAAI,CAAC,AADR,EAAQ,MAAM,CAAC,CAAC,EAAK,IAAM,EAAM,KAAK,GAAG,CAAC,EAAI,EAAW,GAAI,GAAK,EAAQ,MAAM,SAGjG,AAAe,GAAG,CAAd,EAAqB,EAClB,CAAC,EAAY,EAAe,GAAA,CAAG,CAAI,CAC5C,CAEO,SAAS,EAAoB,CAAiB,EACnD,GAAI,EAAQ,MAAM,CAAG,EAAG,OAAO,EAE/B,IAAM,EAAY,EAAQ,MAAM,CAAC,CAAC,EAAK,IAAM,EAAM,EAAG,GAAK,EAAQ,MAAM,CAKzE,OAHwB,AAGjB,KAHsB,IAAI,CADhB,AACiB,EADT,MAAM,CAAC,CAAC,EAAK,IAAM,EAAM,KAAK,GAAG,CAAC,EAAI,EAAW,GAAI,GAAK,EAAQ,MAAM,EAIxE,KAAK,IAAI,CAAC,KAAO,GAC5C,CAEO,SAAS,EAAqB,CAAgB,EACnD,GAAI,EAAO,MAAM,CAAG,EAAG,OAAO,EAE9B,IAAI,EAAc,EACd,EAAO,CAAM,CAAC,EAAE,CAEpB,IAAK,IAAI,EAAI,EAAG,EAAI,EAAO,MAAM,CAAE,IAAK,CAClC,CAAM,CAAC,EAAE,CAAG,IACd,EAAO,AADa,CACP,CAAC,EAAA,AAAE,EAElB,IAAM,EAAY,CAAC,EAAO,CAAM,CAAC,EAAA,AAAE,EAAI,EAAQ,IAC3C,EAAW,IACb,EAAc,CAAA,CAElB,CAEA,IAL8B,GAKvB,CACT,CAEO,SAAS,EAA8B,CAAqC,EACjF,GAAwB,IAApB,EAAS,MAAM,CAAQ,OAAO,EAClC,GAAwB,IAApB,EAAS,MAAM,CAAQ,OAAO,GAElC,IAAM,EAAa,EAAS,MAAM,CAAC,CAAC,EAAK,IAAM,EAAM,EAAE,aAAa,CAAE,GAYtE,OAAO,KAAK,GAAG,CAAC,CALD,EAHH,AAHI,EAAS,AAMN,GANS,AAWJ,CAXK,AAAC,GAAM,EAAE,aAAa,CAAG,GAGlC,MAAM,CAAC,CAAC,EAAK,IAAM,EAAM,KAAK,GAAG,CAAC,EAAG,GAAI,EAG1C,CAAG,CAAI,IAGP,KAAK,GAAG,CAAmB,EAAlB,EAAS,MAAM,CAAM,IAEb,IACtC,CAEO,SAAS,EAAmB,CAAkB,CAAE,CAAmB,EAKxE,OAAO,AAAW,GAHD,KAAK,GAAG,CAAE,EAAa,IAAO,IAAK,KAG5B,AAAU,GAFlB,KAAK,GAAG,CAAC,EAAa,IAGxC,CAEO,SAAS,EACd,CAA+E,EAI/E,IAAM,EAAY,EAAS,MAAM,CAAC,CAAC,EAAK,IAAM,EAAM,EAAE,QAAQ,CAAG,EAAE,cAAc,CAAE,GAC7E,EAAa,EAAS,MAAM,CAAC,CAAC,EAAK,IAAM,EAAM,EAAE,QAAQ,CAAG,EAAE,aAAa,CAAE,GAI7E,EAAoB,EAAE,CACtB,EAJe,AAID,GAJc,CAAA,CAAS,CAAI,EAIb,GAElC,IAAK,IAAI,EAAI,EAAG,EAAI,GAAI,IAAK,CAC3B,IAAM,EAAe,CAAC,KAAK,MAAM,GAAK,EAAA,CAAG,CAAI,IAC7C,CADkD,CAC1C,IAAI,CAAC,EAAc,EAC7B,CAEA,OAAO,CACT,CAL0E,CAO1E,6FAA6F"}